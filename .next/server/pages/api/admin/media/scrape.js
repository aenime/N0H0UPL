"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/admin/media/scrape";
exports.ids = ["pages/api/admin/media/scrape"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fmedia%2Fscrape&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fadmin%2Fmedia%2Fscrape.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fmedia%2Fscrape&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fadmin%2Fmedia%2Fscrape.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_admin_media_scrape_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/admin/media/scrape.ts */ \"(api-node)/./src/pages/api/admin/media/scrape.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_admin_media_scrape_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_admin_media_scrape_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_admin_media_scrape_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_admin_media_scrape_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/admin/media/scrape\",\n        pathname: \"/api/admin/media/scrape\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _src_pages_api_admin_media_scrape_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGYWRtaW4lMkZtZWRpYSUyRnNjcmFwZSZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGYWRtaW4lMkZtZWRpYSUyRnNjcmFwZS50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDRTtBQUMxRDtBQUNrRTtBQUNsRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsaUVBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLGlFQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLHlHQUFtQjtBQUNsRDtBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjL3BhZ2VzL2FwaS9hZG1pbi9tZWRpYS9zY3JhcGUudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FkbWluL21lZGlhL3NjcmFwZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FkbWluL21lZGlhL3NjcmFwZVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fmedia%2Fscrape&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fadmin%2Fmedia%2Fscrape.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./src/pages/api/admin/media/scrape.ts":
/*!*********************************************!*\
  !*** ./src/pages/api/admin/media/scrape.ts ***!
  \*********************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var cheerio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! cheerio */ \"cheerio\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_2__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([cheerio__WEBPACK_IMPORTED_MODULE_0__, axios__WEBPACK_IMPORTED_MODULE_1__]);\n([cheerio__WEBPACK_IMPORTED_MODULE_0__, axios__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nasync function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            message: 'Method not allowed'\n        });\n    }\n    try {\n        const { url, filters } = req.body;\n        console.log('Scraper API called with:', {\n            url,\n            filters\n        });\n        if (!url) {\n            return res.status(400).json({\n                message: 'URL is required'\n            });\n        }\n        // Provide default filters if not provided\n        const defaultFilters = {\n            minWidth: 0,\n            maxWidth: 5000,\n            minHeight: 0,\n            maxHeight: 5000,\n            minFileSize: 0,\n            maxFileSize: 10000,\n            formats: [\n                'jpg',\n                'jpeg',\n                'png',\n                'webp',\n                'gif',\n                'bmp',\n                'svg'\n            ],\n            includeAltText: true,\n            includeVideos: false\n        };\n        const activeFilters = filters ? {\n            ...defaultFilters,\n            ...filters\n        } : defaultFilters;\n        // Validate URL\n        let parsedUrl;\n        try {\n            parsedUrl = new url__WEBPACK_IMPORTED_MODULE_2__.URL(url);\n        } catch (error) {\n            return res.status(400).json({\n                message: 'Invalid URL format'\n            });\n        }\n        // Fetch the webpage\n        const response = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(url, {\n            headers: {\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n                'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',\n                'Accept-Language': 'en-US,en;q=0.5',\n                'Accept-Encoding': 'gzip, deflate',\n                'DNT': '1',\n                'Connection': 'keep-alive',\n                'Upgrade-Insecure-Requests': '1'\n            },\n            timeout: 30000,\n            maxRedirects: 10,\n            validateStatus: function(status) {\n                return status >= 200 && status < 400; // Accept 2xx and 3xx status codes\n            }\n        });\n        const $ = cheerio__WEBPACK_IMPORTED_MODULE_0__.load(response.data);\n        const scrapedMedia = [];\n        // Extract images\n        $('img').each((index, element)=>{\n            const $img = $(element);\n            let src = $img.attr('src') || $img.attr('data-src') || $img.attr('data-lazy');\n            if (!src) return;\n            // Convert relative URLs to absolute\n            if (src.startsWith('//')) {\n                src = parsedUrl.protocol + src;\n            } else if (src.startsWith('/')) {\n                src = `${parsedUrl.protocol}//${parsedUrl.host}${src}`;\n            } else if (!src.startsWith('http')) {\n                src = `${parsedUrl.protocol}//${parsedUrl.host}/${src}`;\n            }\n            const alt = activeFilters.includeAltText ? $img.attr('alt') || '' : '';\n            const name = src.split('/').pop()?.split('?')[0] || `image-${index}`;\n            // Check file format\n            const extension = name.split('.').pop()?.toLowerCase();\n            if (extension && !activeFilters.formats.includes(extension)) {\n                return;\n            }\n            scrapedMedia.push({\n                id: `img-${index}-${Date.now()}`,\n                url: src,\n                name,\n                type: 'image',\n                fileSize: 0,\n                alt,\n                selected: false\n            });\n        });\n        // Extract videos if enabled\n        if (activeFilters.includeVideos) {\n            $('video source, video').each((index, element)=>{\n                const $video = $(element);\n                let src = $video.attr('src');\n                if (!src) return;\n                // Convert relative URLs to absolute\n                if (src.startsWith('//')) {\n                    src = parsedUrl.protocol + src;\n                } else if (src.startsWith('/')) {\n                    src = `${parsedUrl.protocol}//${parsedUrl.host}${src}`;\n                } else if (!src.startsWith('http')) {\n                    src = `${parsedUrl.protocol}//${parsedUrl.host}/${src}`;\n                }\n                const name = src.split('/').pop()?.split('?')[0] || `video-${index}`;\n                scrapedMedia.push({\n                    id: `video-${index}-${Date.now()}`,\n                    url: src,\n                    name,\n                    type: 'video',\n                    fileSize: 0,\n                    alt: '',\n                    selected: false\n                });\n            });\n        }\n        // Validate and get metadata for each media item\n        const validatedMedia = await Promise.all(scrapedMedia.slice(0, 50).map(async (media)=>{\n            try {\n                const headResponse = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].head(media.url, {\n                    timeout: 10000,\n                    headers: {\n                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'\n                    }\n                });\n                const contentLength = parseInt(headResponse.headers['content-length'] || '0');\n                const fileSizeKB = Math.round(contentLength / 1024);\n                // Apply size filters\n                if (fileSizeKB < activeFilters.minFileSize || fileSizeKB > activeFilters.maxFileSize) {\n                    return null;\n                }\n                // For images, try to get dimensions\n                if (media.type === 'image') {\n                    // This is a simplified approach - in a real implementation, \n                    // you might want to use a library like sharp or jimp to get actual dimensions\n                    return {\n                        ...media,\n                        fileSize: fileSizeKB,\n                        dimensions: {\n                            width: 0,\n                            height: 0\n                        } // Placeholder\n                    };\n                }\n                return {\n                    ...media,\n                    fileSize: fileSizeKB\n                };\n            } catch (error) {\n                return {\n                    ...media,\n                    error: 'Failed to load media',\n                    fileSize: 0\n                };\n            }\n        }));\n        // Filter out null results and apply additional filters\n        const finalMedia = validatedMedia.filter((media)=>media !== null).filter((media)=>{\n            if (media.error) return true; // Keep error items to show user\n            // Apply dimension filters for images\n            if (media.type === 'image' && media.dimensions) {\n                const { width, height } = media.dimensions;\n                if (width < activeFilters.minWidth || width > activeFilters.maxWidth || height < activeFilters.minHeight || height > activeFilters.maxHeight) {\n                    return false;\n                }\n            }\n            return true;\n        });\n        res.status(200).json({\n            success: true,\n            media: finalMedia,\n            totalFound: scrapedMedia.length,\n            totalValid: finalMedia.filter((m)=>!m.error).length\n        });\n        console.log('Scraper completed successfully:', {\n            totalFound: scrapedMedia.length,\n            totalValid: finalMedia.filter((m)=>!m.error).length\n        });\n    } catch (error) {\n        console.error('Scraping error:', error);\n        let errorMessage = 'Failed to scrape media';\n        if (axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].isAxiosError(error)) {\n            if (error.code === 'ENOTFOUND') {\n                errorMessage = 'Website not found. Please check the URL.';\n            } else if (error.code === 'ETIMEDOUT') {\n                errorMessage = 'Request timed out. The website may be slow or unresponsive.';\n            } else if (error.response) {\n                const status = error.response.status;\n                if (status === 403) {\n                    errorMessage = 'Access denied. The website may be blocking automated requests.';\n                } else if (status === 404) {\n                    errorMessage = 'Page not found. Please check the URL.';\n                } else if (status >= 500) {\n                    errorMessage = 'The website is experiencing server issues.';\n                } else {\n                    errorMessage = `Website returned error: ${status}`;\n                }\n            } else {\n                errorMessage = 'Network error. Please check your connection.';\n            }\n        } else if (error instanceof Error) {\n            errorMessage = error.message;\n        }\n        res.status(500).json({\n            message: errorMessage,\n            error: error instanceof Error ? error.message : 'Unknown error'\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3NyYy9wYWdlcy9hcGkvYWRtaW4vbWVkaWEvc2NyYXBlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQ21DO0FBQ1Q7QUFDQTtBQTBCWCxlQUFlRyxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBcUI7SUFDOUQ7SUFFQSxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxHQUFHLEVBQUVDLE9BQU8sRUFBRSxHQUE2Q1AsSUFBSVEsSUFBSTtRQUUzRUMsUUFBUUMsR0FBRyxDQUFDLDRCQUE0QjtZQUFFSjtZQUFLQztRQUFRO1FBRXZELElBQUksQ0FBQ0QsS0FBSztZQUNSLE9BQU9MLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7WUFBa0I7UUFDM0Q7UUFFQSwwQ0FBMEM7UUFDMUMsTUFBTU0saUJBQWdDO1lBQ3BDQyxVQUFVO1lBQ1ZDLFVBQVU7WUFDVkMsV0FBVztZQUNYQyxXQUFXO1lBQ1hDLGFBQWE7WUFDYkMsYUFBYTtZQUNiQyxTQUFTO2dCQUFDO2dCQUFPO2dCQUFRO2dCQUFPO2dCQUFRO2dCQUFPO2dCQUFPO2FBQU07WUFDNURDLGdCQUFnQjtZQUNoQkMsZUFBZTtRQUNqQjtRQUVBLE1BQU1DLGdCQUFnQmQsVUFBVTtZQUFFLEdBQUdJLGNBQWM7WUFBRSxHQUFHSixPQUFPO1FBQUMsSUFBSUk7UUFFcEUsZUFBZTtRQUNmLElBQUlXO1FBQ0osSUFBSTtZQUNGQSxZQUFZLElBQUl4QixvQ0FBR0EsQ0FBQ1E7UUFDdEIsRUFBRSxPQUFPaUIsT0FBTztZQUNkLE9BQU90QixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxTQUFTO1lBQXFCO1FBQzlEO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1tQixXQUFXLE1BQU0zQixpREFBUyxD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QUFNNEQsSUFBSSxLQUFLLGFBQWE7Z0JBQ3JDRixlQUFlO1lBQ2pCLE9BQU8sSUFBSTFELE1BQU1DLFFBQVEsRUFBRTtnQkFDekIsTUFBTXJCLFNBQVNvQixNQUFNQyxRQUFRLENBQUNyQixNQUFNO2dCQUNwQyxJQUFJQSxXQUFXLEtBQUs7b0JBQ2xCOEUsZUFBZTtnQkFDakIsT0FBTyxJQUFJOUUsV0FBVyxLQUFLO29CQUN6QjhFLGVBQWU7Z0JBQ2pCLE9BQU8sSUFBSTlFLFVBQVUsS0FBSztvQkFDeEI4RSxlQUFlO2dCQUNqQixPQUFPO29CQUNMQSxlQUFlLENBQUMsd0JBQXdCLEVBQUU5RSxRQUFRO2dCQUNwRDtZQUNGLE9BQU87Z0JBQ0w4RSxlQUFlO1lBQ2pCO1FBQ0YsT0FBTyxJQUFJMUQsaUJBQWlCNkQsT0FBTztZQUNqQ0gsZUFBZTFELE1BQU1sQixPQUFPO1FBQzlCO1FBRUFKLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJDLFNBQVM0RTtZQUNUMUQsT0FBT0EsaUJBQWlCNkQsUUFBUTdELE1BQU1sQixPQUFPLEdBQUc7UUFDbEQ7SUFDRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvYW5hbmQuc29jaWFsL0RvY3VtZW50cy9uMGgwdXBsL3NyYy9wYWdlcy9hcGkvYWRtaW4vbWVkaWEvc2NyYXBlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCAqIGFzIGNoZWVyaW8gZnJvbSAnY2hlZXJpbyc7XG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHsgVVJMIH0gZnJvbSAndXJsJztcblxuaW50ZXJmYWNlIFNjcmFwZUZpbHRlcnMge1xuICBtaW5XaWR0aDogbnVtYmVyO1xuICBtYXhXaWR0aDogbnVtYmVyO1xuICBtaW5IZWlnaHQ6IG51bWJlcjtcbiAgbWF4SGVpZ2h0OiBudW1iZXI7XG4gIG1pbkZpbGVTaXplOiBudW1iZXI7IC8vIGluIEtCXG4gIG1heEZpbGVTaXplOiBudW1iZXI7IC8vIGluIEtCXG4gIGZvcm1hdHM6IHN0cmluZ1tdO1xuICBpbmNsdWRlQWx0VGV4dDogYm9vbGVhbjtcbiAgaW5jbHVkZVZpZGVvczogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIFNjcmFwZWRNZWRpYSB7XG4gIGlkOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHR5cGU6ICdpbWFnZScgfCAndmlkZW8nO1xuICBkaW1lbnNpb25zPzogeyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9O1xuICBmaWxlU2l6ZTogbnVtYmVyO1xuICBhbHQ6IHN0cmluZztcbiAgc2VsZWN0ZWQ6IGJvb2xlYW47XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBtZXNzYWdlOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyB1cmwsIGZpbHRlcnMgfTogeyB1cmw6IHN0cmluZzsgZmlsdGVycz86IFNjcmFwZUZpbHRlcnMgfSA9IHJlcS5ib2R5O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdTY3JhcGVyIEFQSSBjYWxsZWQgd2l0aDonLCB7IHVybCwgZmlsdGVycyB9KTtcblxuICAgIGlmICghdXJsKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnVVJMIGlzIHJlcXVpcmVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyBQcm92aWRlIGRlZmF1bHQgZmlsdGVycyBpZiBub3QgcHJvdmlkZWRcbiAgICBjb25zdCBkZWZhdWx0RmlsdGVyczogU2NyYXBlRmlsdGVycyA9IHtcbiAgICAgIG1pbldpZHRoOiAwLFxuICAgICAgbWF4V2lkdGg6IDUwMDAsXG4gICAgICBtaW5IZWlnaHQ6IDAsXG4gICAgICBtYXhIZWlnaHQ6IDUwMDAsXG4gICAgICBtaW5GaWxlU2l6ZTogMCxcbiAgICAgIG1heEZpbGVTaXplOiAxMDAwMCxcbiAgICAgIGZvcm1hdHM6IFsnanBnJywgJ2pwZWcnLCAncG5nJywgJ3dlYnAnLCAnZ2lmJywgJ2JtcCcsICdzdmcnXSxcbiAgICAgIGluY2x1ZGVBbHRUZXh0OiB0cnVlLFxuICAgICAgaW5jbHVkZVZpZGVvczogZmFsc2VcbiAgICB9O1xuXG4gICAgY29uc3QgYWN0aXZlRmlsdGVycyA9IGZpbHRlcnMgPyB7IC4uLmRlZmF1bHRGaWx0ZXJzLCAuLi5maWx0ZXJzIH0gOiBkZWZhdWx0RmlsdGVycztcblxuICAgIC8vIFZhbGlkYXRlIFVSTFxuICAgIGxldCBwYXJzZWRVcmw6IFVSTDtcbiAgICB0cnkge1xuICAgICAgcGFyc2VkVXJsID0gbmV3IFVSTCh1cmwpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnSW52YWxpZCBVUkwgZm9ybWF0JyB9KTtcbiAgICB9XG5cbiAgICAvLyBGZXRjaCB0aGUgd2VicGFnZVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHVybCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTEuMC40NDcyLjEyNCBTYWZhcmkvNTM3LjM2JyxcbiAgICAgICAgJ0FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLCovKjtxPTAuOCcsXG4gICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjUnLFxuICAgICAgICAnQWNjZXB0LUVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUnLFxuICAgICAgICAnRE5UJzogJzEnLFxuICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJyxcbiAgICAgICAgJ1VwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHMnOiAnMScsXG4gICAgICB9LFxuICAgICAgdGltZW91dDogMzAwMDAsXG4gICAgICBtYXhSZWRpcmVjdHM6IDEwLFxuICAgICAgdmFsaWRhdGVTdGF0dXM6IGZ1bmN0aW9uIChzdGF0dXMpIHtcbiAgICAgICAgcmV0dXJuIHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgNDAwOyAvLyBBY2NlcHQgMnh4IGFuZCAzeHggc3RhdHVzIGNvZGVzXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCAkID0gY2hlZXJpby5sb2FkKHJlc3BvbnNlLmRhdGEpO1xuICAgIGNvbnN0IHNjcmFwZWRNZWRpYTogU2NyYXBlZE1lZGlhW10gPSBbXTtcblxuICAgIC8vIEV4dHJhY3QgaW1hZ2VzXG4gICAgJCgnaW1nJykuZWFjaCgoaW5kZXgsIGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0ICRpbWcgPSAkKGVsZW1lbnQpO1xuICAgICAgbGV0IHNyYyA9ICRpbWcuYXR0cignc3JjJykgfHwgJGltZy5hdHRyKCdkYXRhLXNyYycpIHx8ICRpbWcuYXR0cignZGF0YS1sYXp5Jyk7XG4gICAgICBcbiAgICAgIGlmICghc3JjKSByZXR1cm47XG5cbiAgICAgIC8vIENvbnZlcnQgcmVsYXRpdmUgVVJMcyB0byBhYnNvbHV0ZVxuICAgICAgaWYgKHNyYy5zdGFydHNXaXRoKCcvLycpKSB7XG4gICAgICAgIHNyYyA9IHBhcnNlZFVybC5wcm90b2NvbCArIHNyYztcbiAgICAgIH0gZWxzZSBpZiAoc3JjLnN0YXJ0c1dpdGgoJy8nKSkge1xuICAgICAgICBzcmMgPSBgJHtwYXJzZWRVcmwucHJvdG9jb2x9Ly8ke3BhcnNlZFVybC5ob3N0fSR7c3JjfWA7XG4gICAgICB9IGVsc2UgaWYgKCFzcmMuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgIHNyYyA9IGAke3BhcnNlZFVybC5wcm90b2NvbH0vLyR7cGFyc2VkVXJsLmhvc3R9LyR7c3JjfWA7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFsdCA9IGFjdGl2ZUZpbHRlcnMuaW5jbHVkZUFsdFRleHQgPyAoJGltZy5hdHRyKCdhbHQnKSB8fCAnJykgOiAnJztcbiAgICAgIGNvbnN0IG5hbWUgPSBzcmMuc3BsaXQoJy8nKS5wb3AoKT8uc3BsaXQoJz8nKVswXSB8fCBgaW1hZ2UtJHtpbmRleH1gO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBmaWxlIGZvcm1hdFxuICAgICAgY29uc3QgZXh0ZW5zaW9uID0gbmFtZS5zcGxpdCgnLicpLnBvcCgpPy50b0xvd2VyQ2FzZSgpO1xuICAgICAgaWYgKGV4dGVuc2lvbiAmJiAhYWN0aXZlRmlsdGVycy5mb3JtYXRzLmluY2x1ZGVzKGV4dGVuc2lvbikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBzY3JhcGVkTWVkaWEucHVzaCh7XG4gICAgICAgIGlkOiBgaW1nLSR7aW5kZXh9LSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICB1cmw6IHNyYyxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgdHlwZTogJ2ltYWdlJyxcbiAgICAgICAgZmlsZVNpemU6IDAsIC8vIFdpbGwgYmUgZGV0ZXJtaW5lZCB3aGVuIGFjdHVhbGx5IGRvd25sb2FkaW5nXG4gICAgICAgIGFsdCxcbiAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIEV4dHJhY3QgdmlkZW9zIGlmIGVuYWJsZWRcbiAgICBpZiAoYWN0aXZlRmlsdGVycy5pbmNsdWRlVmlkZW9zKSB7XG4gICAgICAkKCd2aWRlbyBzb3VyY2UsIHZpZGVvJykuZWFjaCgoaW5kZXgsIGVsZW1lbnQpID0+IHtcbiAgICAgICAgY29uc3QgJHZpZGVvID0gJChlbGVtZW50KTtcbiAgICAgICAgbGV0IHNyYyA9ICR2aWRlby5hdHRyKCdzcmMnKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghc3JjKSByZXR1cm47XG5cbiAgICAgICAgLy8gQ29udmVydCByZWxhdGl2ZSBVUkxzIHRvIGFic29sdXRlXG4gICAgICAgIGlmIChzcmMuc3RhcnRzV2l0aCgnLy8nKSkge1xuICAgICAgICAgIHNyYyA9IHBhcnNlZFVybC5wcm90b2NvbCArIHNyYztcbiAgICAgICAgfSBlbHNlIGlmIChzcmMuc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgc3JjID0gYCR7cGFyc2VkVXJsLnByb3RvY29sfS8vJHtwYXJzZWRVcmwuaG9zdH0ke3NyY31gO1xuICAgICAgICB9IGVsc2UgaWYgKCFzcmMuc3RhcnRzV2l0aCgnaHR0cCcpKSB7XG4gICAgICAgICAgc3JjID0gYCR7cGFyc2VkVXJsLnByb3RvY29sfS8vJHtwYXJzZWRVcmwuaG9zdH0vJHtzcmN9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5hbWUgPSBzcmMuc3BsaXQoJy8nKS5wb3AoKT8uc3BsaXQoJz8nKVswXSB8fCBgdmlkZW8tJHtpbmRleH1gO1xuXG4gICAgICAgIHNjcmFwZWRNZWRpYS5wdXNoKHtcbiAgICAgICAgICBpZDogYHZpZGVvLSR7aW5kZXh9LSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgIHVybDogc3JjLFxuICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgdHlwZTogJ3ZpZGVvJyxcbiAgICAgICAgICBmaWxlU2l6ZTogMCxcbiAgICAgICAgICBhbHQ6ICcnLFxuICAgICAgICAgIHNlbGVjdGVkOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGFuZCBnZXQgbWV0YWRhdGEgZm9yIGVhY2ggbWVkaWEgaXRlbVxuICAgIGNvbnN0IHZhbGlkYXRlZE1lZGlhID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICBzY3JhcGVkTWVkaWEuc2xpY2UoMCwgNTApLm1hcChhc3luYyAobWVkaWEpID0+IHsgLy8gTGltaXQgdG8gNTAgaXRlbXMgZm9yIHBlcmZvcm1hbmNlXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgaGVhZFJlc3BvbnNlID0gYXdhaXQgYXhpb3MuaGVhZChtZWRpYS51cmwsIHtcbiAgICAgICAgICAgIHRpbWVvdXQ6IDEwMDAwLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBjb250ZW50TGVuZ3RoID0gcGFyc2VJbnQoaGVhZFJlc3BvbnNlLmhlYWRlcnNbJ2NvbnRlbnQtbGVuZ3RoJ10gfHwgJzAnKTtcbiAgICAgICAgICBjb25zdCBmaWxlU2l6ZUtCID0gTWF0aC5yb3VuZChjb250ZW50TGVuZ3RoIC8gMTAyNCk7XG5cbiAgICAgICAgICAvLyBBcHBseSBzaXplIGZpbHRlcnNcbiAgICAgICAgICBpZiAoZmlsZVNpemVLQiA8IGFjdGl2ZUZpbHRlcnMubWluRmlsZVNpemUgfHwgZmlsZVNpemVLQiA+IGFjdGl2ZUZpbHRlcnMubWF4RmlsZVNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEZvciBpbWFnZXMsIHRyeSB0byBnZXQgZGltZW5zaW9uc1xuICAgICAgICAgIGlmIChtZWRpYS50eXBlID09PSAnaW1hZ2UnKSB7XG4gICAgICAgICAgICAvLyBUaGlzIGlzIGEgc2ltcGxpZmllZCBhcHByb2FjaCAtIGluIGEgcmVhbCBpbXBsZW1lbnRhdGlvbiwgXG4gICAgICAgICAgICAvLyB5b3UgbWlnaHQgd2FudCB0byB1c2UgYSBsaWJyYXJ5IGxpa2Ugc2hhcnAgb3IgamltcCB0byBnZXQgYWN0dWFsIGRpbWVuc2lvbnNcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIC4uLm1lZGlhLFxuICAgICAgICAgICAgICBmaWxlU2l6ZTogZmlsZVNpemVLQixcbiAgICAgICAgICAgICAgZGltZW5zaW9uczogeyB3aWR0aDogMCwgaGVpZ2h0OiAwIH0gLy8gUGxhY2Vob2xkZXJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIC4uLm1lZGlhLFxuICAgICAgICAgICAgZmlsZVNpemU6IGZpbGVTaXplS0JcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5tZWRpYSxcbiAgICAgICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGxvYWQgbWVkaWEnLFxuICAgICAgICAgICAgZmlsZVNpemU6IDBcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IG51bGwgcmVzdWx0cyBhbmQgYXBwbHkgYWRkaXRpb25hbCBmaWx0ZXJzXG4gICAgY29uc3QgZmluYWxNZWRpYSA9IHZhbGlkYXRlZE1lZGlhXG4gICAgICAuZmlsdGVyKChtZWRpYSk6IG1lZGlhIGlzIFNjcmFwZWRNZWRpYSA9PiBtZWRpYSAhPT0gbnVsbClcbiAgICAgIC5maWx0ZXIobWVkaWEgPT4ge1xuICAgICAgICBpZiAobWVkaWEuZXJyb3IpIHJldHVybiB0cnVlOyAvLyBLZWVwIGVycm9yIGl0ZW1zIHRvIHNob3cgdXNlclxuXG4gICAgICAgIC8vIEFwcGx5IGRpbWVuc2lvbiBmaWx0ZXJzIGZvciBpbWFnZXNcbiAgICAgICAgaWYgKG1lZGlhLnR5cGUgPT09ICdpbWFnZScgJiYgbWVkaWEuZGltZW5zaW9ucykge1xuICAgICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gbWVkaWEuZGltZW5zaW9ucztcbiAgICAgICAgICBpZiAod2lkdGggPCBhY3RpdmVGaWx0ZXJzLm1pbldpZHRoIHx8IHdpZHRoID4gYWN0aXZlRmlsdGVycy5tYXhXaWR0aCB8fFxuICAgICAgICAgICAgICBoZWlnaHQgPCBhY3RpdmVGaWx0ZXJzLm1pbkhlaWdodCB8fCBoZWlnaHQgPiBhY3RpdmVGaWx0ZXJzLm1heEhlaWdodCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSk7XG5cbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVkaWE6IGZpbmFsTWVkaWEsXG4gICAgICB0b3RhbEZvdW5kOiBzY3JhcGVkTWVkaWEubGVuZ3RoLFxuICAgICAgdG90YWxWYWxpZDogZmluYWxNZWRpYS5maWx0ZXIobSA9PiAhbS5lcnJvcikubGVuZ3RoXG4gICAgfSk7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ1NjcmFwZXIgY29tcGxldGVkIHN1Y2Nlc3NmdWxseTonLCB7XG4gICAgICB0b3RhbEZvdW5kOiBzY3JhcGVkTWVkaWEubGVuZ3RoLFxuICAgICAgdG90YWxWYWxpZDogZmluYWxNZWRpYS5maWx0ZXIobSA9PiAhbS5lcnJvcikubGVuZ3RoXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdTY3JhcGluZyBlcnJvcjonLCBlcnJvcik7XG4gICAgXG4gICAgbGV0IGVycm9yTWVzc2FnZSA9ICdGYWlsZWQgdG8gc2NyYXBlIG1lZGlhJztcbiAgICBcbiAgICBpZiAoYXhpb3MuaXNBeGlvc0Vycm9yKGVycm9yKSkge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdFTk9URk9VTkQnKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9ICdXZWJzaXRlIG5vdCBmb3VuZC4gUGxlYXNlIGNoZWNrIHRoZSBVUkwuJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IuY29kZSA9PT0gJ0VUSU1FRE9VVCcpIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ1JlcXVlc3QgdGltZWQgb3V0LiBUaGUgd2Vic2l0ZSBtYXkgYmUgc2xvdyBvciB1bnJlc3BvbnNpdmUuJztcbiAgICAgIH0gZWxzZSBpZiAoZXJyb3IucmVzcG9uc2UpIHtcbiAgICAgICAgY29uc3Qgc3RhdHVzID0gZXJyb3IucmVzcG9uc2Uuc3RhdHVzO1xuICAgICAgICBpZiAoc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAnQWNjZXNzIGRlbmllZC4gVGhlIHdlYnNpdGUgbWF5IGJlIGJsb2NraW5nIGF1dG9tYXRlZCByZXF1ZXN0cy4nO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ1BhZ2Ugbm90IGZvdW5kLiBQbGVhc2UgY2hlY2sgdGhlIFVSTC4nO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXR1cyA+PSA1MDApIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSAnVGhlIHdlYnNpdGUgaXMgZXhwZXJpZW5jaW5nIHNlcnZlciBpc3N1ZXMuJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBgV2Vic2l0ZSByZXR1cm5lZCBlcnJvcjogJHtzdGF0dXN9YDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXJyb3JNZXNzYWdlID0gJ05ldHdvcmsgZXJyb3IuIFBsZWFzZSBjaGVjayB5b3VyIGNvbm5lY3Rpb24uJztcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgfVxuICAgIFxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiBlcnJvck1lc3NhZ2UsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNoZWVyaW8iLCJheGlvcyIsIlVSTCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsInVybCIsImZpbHRlcnMiLCJib2R5IiwiY29uc29sZSIsImxvZyIsImRlZmF1bHRGaWx0ZXJzIiwibWluV2lkdGgiLCJtYXhXaWR0aCIsIm1pbkhlaWdodCIsIm1heEhlaWdodCIsIm1pbkZpbGVTaXplIiwibWF4RmlsZVNpemUiLCJmb3JtYXRzIiwiaW5jbHVkZUFsdFRleHQiLCJpbmNsdWRlVmlkZW9zIiwiYWN0aXZlRmlsdGVycyIsInBhcnNlZFVybCIsImVycm9yIiwicmVzcG9uc2UiLCJnZXQiLCJoZWFkZXJzIiwidGltZW91dCIsIm1heFJlZGlyZWN0cyIsInZhbGlkYXRlU3RhdHVzIiwiJCIsImxvYWQiLCJkYXRhIiwic2NyYXBlZE1lZGlhIiwiZWFjaCIsImluZGV4IiwiZWxlbWVudCIsIiRpbWciLCJzcmMiLCJhdHRyIiwic3RhcnRzV2l0aCIsInByb3RvY29sIiwiaG9zdCIsImFsdCIsIm5hbWUiLCJzcGxpdCIsInBvcCIsImV4dGVuc2lvbiIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJwdXNoIiwiaWQiLCJEYXRlIiwibm93IiwidHlwZSIsImZpbGVTaXplIiwic2VsZWN0ZWQiLCIkdmlkZW8iLCJ2YWxpZGF0ZWRNZWRpYSIsIlByb21pc2UiLCJhbGwiLCJzbGljZSIsIm1hcCIsIm1lZGlhIiwiaGVhZFJlc3BvbnNlIiwiaGVhZCIsImNvbnRlbnRMZW5ndGgiLCJwYXJzZUludCIsImZpbGVTaXplS0IiLCJNYXRoIiwicm91bmQiLCJkaW1lbnNpb25zIiwid2lkdGgiLCJoZWlnaHQiLCJmaW5hbE1lZGlhIiwiZmlsdGVyIiwic3VjY2VzcyIsInRvdGFsRm91bmQiLCJsZW5ndGgiLCJ0b3RhbFZhbGlkIiwibSIsImVycm9yTWVzc2FnZSIsImlzQXhpb3NFcnJvciIsImNvZGUiLCJFcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./src/pages/api/admin/media/scrape.ts\n");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "cheerio":
/*!**************************!*\
  !*** external "cheerio" ***!
  \**************************/
/***/ ((module) => {

module.exports = import("cheerio");;

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fadmin%2Fmedia%2Fscrape&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Fadmin%2Fmedia%2Fscrape.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();